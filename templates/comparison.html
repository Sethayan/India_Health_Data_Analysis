{% extends 'layouts/base.html' %}

{% block title %}Comparative View{% endblock %}

{% block content %}

<div class="page-header mb-4">
    <div class="row align-items-center">
        <div class="col">
            <h1 class="page-title">
                <i class="fa fa-exchange text-primary me-2"></i>
                Comparative View
            </h1>
        </div>
    </div>
</div>


<div class="row mb-4">
    <div class="col-12">
        <div class="card border-0 shadow-sm">
            <div class="card-body">
                <div class="btn-group" role="group">
                    <input type="radio" class="btn-check" name="timeRange" id="range2005" value="2005" checked>
                    <label class="btn btn-outline-primary" for="range2005">
                        <i class="fa fa-calendar me-1"></i> 2005 vs 2023
                    </label>
                    <input type="radio" class="btn-check" name="timeRange" id="range2022" value="2022">
                    <label class="btn btn-outline-primary" for="range2022">
                        <i class="fa fa-calendar me-1"></i> 2022 vs 2023
                    </label>
                </div>
            </div>
        </div>
    </div>
</div>


<div id="comparison2005" class="comparison-section">

    <div class="row g-4 mb-4">
        <div class="col-xl-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-0">
                    <h5 class="card-title mb-0">
                        <i class="fa fa-bar-chart text-primary me-2"></i>
                        Sub Centres: 2005 vs 2023
                    </h5>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="height: 350px;">
                        <canvas id="scComparisonChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-0">
                    <h5 class="card-title mb-0">
                        <i class="fa fa-bar-chart text-success me-2"></i>
                        PHCs: 2005 vs 2023
                    </h5>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="height: 350px;">
                        <canvas id="phcComparisonChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row g-4 mb-4">
        <div class="col-xl-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-0">
                    <h5 class="card-title mb-0">
                        <i class="fa fa-bar-chart text-info me-2"></i>
                        CHCs: 2005 vs 2023
                    </h5>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="height: 350px;">
                        <canvas id="chcComparisonChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-0">
                    <h5 class="card-title mb-0">
                        <i class="fa fa-user-md text-warning me-2"></i>
                        Doctors at PHCs: 2005 vs 2023
                    </h5>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="height: 350px;">
                        <canvas id="doctorsComparisonChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-0 d-flex justify-content-between align-items-center">
                    <h5 class="card-title mb-0">
                        <i class="fa fa-table text-primary me-2"></i>
                        State-wise Infrastructure Comparison (2005 vs 2023)
                    </h5>
                    <div class="input-group" style="width: 250px;">
                        <span class="input-group-text"><i class="fa fa-search"></i></span>
                        <input type="text" class="form-control" id="infraSearchInput" placeholder="Search state...">
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover table-striped" id="infraComparisonTable">
                            <thead class="table-dark">
                                <tr>
                                    <th>State/UT</th>
                                    <th class="text-center">SC 2005</th>
                                    <th class="text-center">SC 2023</th>
                                    <th class="text-center">SC Change</th>
                                    <th class="text-center">PHC 2005</th>
                                    <th class="text-center">PHC 2023</th>
                                    <th class="text-center">PHC Change</th>
                                    <th class="text-center">CHC 2005</th>
                                    <th class="text-center">CHC 2023</th>
                                    <th class="text-center">CHC Change</th>
                                </tr>
                            </thead>
                            <tbody id="infraTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div id="comparison2022" class="comparison-section" style="display: none;">
    <div class="row g-4 mb-4">
        <div class="col-xl-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-0">
                    <h5 class="card-title mb-0">
                        <i class="fa fa-line-chart text-primary me-2"></i>
                        Infrastructure: March 2022 vs March 2023
                    </h5>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="height: 350px;">
                        <canvas id="yearly2022Chart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-0">
                    <h5 class="card-title mb-0">
                        <i class="fa fa-users text-success me-2"></i>
                        Manpower: March 2022 vs March 2023
                    </h5>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="height: 350px;">
                        <canvas id="manpower2022Chart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/comparison_view.js') }}"></script>
<script>
    const comparisonData = {{ comparison_data | safe }};
    const yearlyData = {{ yearly_data | safe }};
    
    $(document).ready(function() {
        initComparisonCharts(comparisonData, yearlyData);
        
        // Time range toggle
        $('input[name="timeRange"]').on('change', function() {
            const value = $(this).val();
            if (value === '2005') {
                $('#comparison2005').show();
                $('#comparison2022').hide();
            } else {
                $('#comparison2005').hide();
                $('#comparison2022').show();
            }
        });
        
        // Search box for table
        $('#infraSearchInput').on('keyup', function() {
            const value = $(this).val().toLowerCase();
            $('#infraTableBody tr').filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
            });
        });
    });
</script>
{% endblock %}  